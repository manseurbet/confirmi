<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Transactions - Confirmi</title>
<style>
body { font-family: Arial; background:#f5f6f8; padding:30px; }
table { width:100%; border-collapse:collapse; background:#fff; }
th, td { padding:10px; border:1px solid #ddd; text-align:left; }
th { background:#eee; }
.confirmed { color:green; font-weight:bold; }
.pending { color:orange; font-weight:bold; }
a { color:#007bff; text-decoration:none; }
</style>
</head>
<body>

<h2>Liste des transactions</h2>

<table id="transactionsTable">
  <thead>
    <tr>
      <th>Client</th>
      <th>Produit</th>
      <th>Montant</th>
      <th>Paiement</th>
      <th>Statut</th>
      <th>Lien client</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
async function loadTransactions() {
  const res = await fetch("/transactions");
  const data = await res.json();

  if (!data.success) {
    alert("Erreur chargement transactions");
    return;
  }

  const tbody = document.querySelector("#transactionsTable tbody");
  tbody.innerHTML = "";

  data.transactions.forEach(t => {
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${t.clientName || ""}</td>
      <td>${t.productRef || ""}</td>
      <td>${t.amount || ""}</td>
      <td>${t.paymentMethod || "-"}</td>
      <td class="${t.confirmed ? "confirmed" : "pending"}">
        ${t.confirmed ? "Confirm√©e" : "En attente"}
      </td>
      <td>
        <a href="/client.html?id=${t.transactionId}" target="_blank">
          Ouvrir
        </a>
      </td>
    `;

    tbody.appendChild(tr);
  });
}

loadTransactions();
</script>

</body>
</html>
